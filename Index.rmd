---
title: "Retrospective Health Data Analysis"
author: "Olamide Adu"
date: "2023-03-25"
output:
  html_document:
    toc: true
    toc_depth: 2
    toc_float: true
    dev: svg
    theme: simplex
    highlight: zenburn
    code_folding: show
    df_print: paged
editor_options: 
  markdown: 
    wrap: 72
---

# Retrospective Health-data Analysis
Retrospective exploratory data analysis of intensive care unit health-data downloaded from kaggle.com already preprocessed by user @saurabhshahane.

**NB**: The [data](https://www.kaggle.com/datasets/saurabhshahane/in-hospital-mortality-prediction) used is part of a whole data from [**MIMIC III original database**](https://www.kaggle.com/datasets/drscarlat/mimic2-original-icu/download?datasetVersionNumber=1).

Data usage is mainly for exploratory data, improving analytical skills using some analytics tools. Mainly
![R](https://raw.githubusercontent.com/xrander/Health-data/master/Resource/4375063_logo_project_r_icon.png)
and
![](https://github.com/xrander/Health-data/raw/master/Resource/4691328_postgresql_icon.png)

## The Data
We load the libraries for reading and analyzing the data first.

```{r load_libraries, message=FALSE, results='hide'}
# Load the doBy library for advanced data manipulation and data aggregation
library('doBy')

# Load the tidyverse library for data manipulation and visualization
library('tidyverse')

# Load the lattice library for advanced graphical presentation
library('lattice')
```
Next we import the data.frame

```{r load_data, message = FALSE, cols.print = 15}
# Import the data
health_rec <- read_csv('https://raw.githubusercontent.com/xrander/Health-data/master/Health_data.csv')

# Preview the first ten rows of the data
head(health_rec, n = 10)
```

# Description of the Data

The MIMIC-III database is publicly a available critical care database containing de-identified data on 46520 patients and 58976 admissions to the ICU of the Beth Israel Deaconess Medical Center, Boston, USA between
2001 and 2008. The data used for this study is limited to a bit more than 1000 patient only.
![](https://news.mit.edu/sites/default/files/images/202207/MIT-Healthcare-Technology-01.jpg)

## Data Definition

-   group_num

-   ID: The patient ID

-   outcome: 0 = Alive and 1 = Dead

-   age: the age of the patient

-   gender: 1 = Male and 2 = Female

-   BMI: Body Mass Index

-   hypertensive: 0 = with and 1 = without

-   atrialfibrillation: 0 = with and 1 = without

-   CHD_with_no_MI: Coronary heart disease with Myocardial infarction, 0 = with and 1 without

-   diabetes: 0 = with and 1 without

-   deficiencyanemias: 0 = with and 1 = without

-   depression: 0 = with and 1 = without

-   Hyperlipemia:this refers to high concentration of fats or lipids in the blood. 0 = with and 1 = without

-   Renal_failure: 0 = without renal failure and 1 = with renal failure

-   COPD: chronic obstructive pulmonary disease(A disease causing airflow blockage and breathing related problems). 0 = without and 1 = without

-   heart_rate: a range of 60 to 100 bpm is considered normal

-   Systolic_blood_pressure: measure of the pressure in arteries when the heart beats.

-   Diastolic_blood_pressure: measure of the pressure in the arteries when the heart rests between beats

-   Respiratory_rate: this is the number of breathes per minute. The normal range is between 12-20, anything under above or below this range is abnormal. 25 is considered too high.

-   temperature

-   SP_O2: Oxygen saturation (measure of how much oxygen the blood carries as a percentage of the maximum it could carry). The normal range for healthy individuals is between 96% to 99%

-   Urine_output

-   hematocrit: percentage volume of red blood cells in the blood.

-   RBC: acronym for Red Blood Count.

-   MCH: Mean Corpuscular Hemoglobin, this is the average amount of hemoglobin in each of the red blood cells

-   MCHC: Mean Cell Hemoglobin Concentration, this is the average concentration of hemoglobin in a given volume of blood.

-   MCV: Mean Corpuscular Volume, this is the measure of the average size of the red clood cells

-   RDW: red cell distribution width. it is the differences in the volume and size of the red blood cells

-   Leucocyte

-   Platelets

-   Neutrophils

-   Basophils

-   Lymphocyte

-   PT: measure of the time it takes the liquid portion of the blood to clot.

-   INR

-   NT_proBNP: a measure of heart failure.

-   Creatine_kinase

-   Creatinine

-   Urea_nitrogen

-   glucose

-   Blood_potassium

-   Blood_sodium

-   Blood_calcium

-   Chloride

-   Anion_gap: measures the difference between the negatively and positively charged electrolytes in the blood.

-   Magnesium_ion

-   PH

-   Bicarbonate

-   Lactic_acid

-   PCO2: Partial Pressure of Carbon Dioxide, this measures the carbondioxide within the arterial or venous blood.

-   EF: Ejection Fraction: Used to gauge how healthy the heart is. It is the amount of blood that the heart pumps each time it beats.

# Questions

Based on the data available the following questions will be answered:

1.   Which age group is the most in the hospital?

2.   which age group of patients dies more in the hospital?

3.   which gender is the most prevalent in the hospital?

4.   which gender group is having the highest number of death?

5.   how many patients died in the hospital with atrial fibrillation?

6.   how many patients in the hospital have depression?

7.   what is the rate of non-survived patients with hypertension?

8.   Rate of gender with hypertension

9.   How many patients with renal failure are alive in the hospital?

10.   how many patients in the hospital with Hyperlipemia are dead?

11.   how many patients in the hospital with Anemia are dead?

12.   What is the proportion of survival and non-survival between diabetic and non-diabetic patients

13.  What is the proportion of survival and non-survival between depressed and non-depressed patients

# Data Preparation and Preprocessing

> **Note:** The PostgreSQL code solution to the question asked are
> [here](https://raw.githubusercontent.com/xrander/Health-data/master/Health_data_analysis.sql)

##Understanding the Data
It is important we understand the data

### The Data Structure
```{r data_structure,message=FALSE}
# data structure
str(health_rec) 
```
At first glance, all the variables are numeric type. There are `r dim(health_rec)[1]` observations and `r dim(health_rec)[2]` variables. Some of the variables of the data does not follow the data definition. A quick descriptive summary of the data shows this.

**Descriptive**
```{r data_stats}
# quick descriptive statistics of the data
summary(health_rec)
```

### Data transformation
We can expect two categories of data type according to the data description. The first is categorical variables for data which min is 0 and max is 1, and the other is numeric variables. We deal with data that are having the wrong structure, i.e. type, and also assigns labels to the categorical variables.

The descriptive statistics also shows the min and max age as `r min(health_rec$age)` and `r max(health_rec$age)`. 

```{r}
# Change the categorical variables to factor data type
health_rec <- health_rec %>%
  mutate(outcome = factor(outcome, levels = c(0,1), labels = c("Alive", "Dead")),
         gender = factor(gender, levels = c(1, 2), labels = c("Male", "Female")),
         hypertensive = factor(hypertensive, levels = c(0,1), labels = c("Having", "Not having")),
         atrialfibrillation = factor(atrialfibrillation, levels = c(0,1), labels = c("Having", "Not having")),
         CHD_with_no_MI = factor(CHD_with_no_MI, levels = c(0,1), labels = c("Having", "Not Having")),
         diabetes = factor(diabetes, levels = c(0,1), labels = c("Having", "Not Having")),
         depression = factor(depression, levels = c(0,1), labels = c("Having", "Not Having")),
         Hyperlipemia = factor(Hyperlipemia, levels = c(0,1), labels = c("Having", "Not Having")),
         Renal_failure = factor(Renal_failure, levels = c(0,1), labels = c("Not Having", "Having")),
         COPD = factor(COPD, levels = c(0,1), labels = c(" Not Having", "Having")))
```

### Missing values
Next, we investigate the data for missing values. It is alright to have some missing values for some variables, but the outcome should be known, as it is important to see if patients are dead or alive. Outcome will be used to handle the missing data.
```{r}
# Remove missing data from the outcome variable
health_rec <- health_rec%>%
  filter(!is.na(outcome))
```

There is no missing data again in the outcome of patients. The data have been reduced from 1177 to `dim(health_rec)[1]`.

# Data Analysis and Solution to Questions
A majority of the question asked are descriptive statistics questions and answers will be provided using visualization and tables.

## Descriptive Statistics
### Age
**The age group with the highest frequency**: To do this, we have to bin the age variable, creating a class range, then we can create a summary of the age_group and see their frequency
```{r age_group_frequency}
# Create bins
age_categories <- seq(0, 120, by = 20) # We assume the highest age is not above 120 years old

# Create age interval variable
health_rec <- health_rec %>%
  mutate(age_group = cut(age,
                         breaks = age_categories,
                         include.lowest = T, # To indicate if x is the lowest
                         ordered_result = F)) #This ensures that the factor variable is not ordered

health_rec %>%
  group_by(age_group) %>%
  summarize(frequency = n())
```
Older people are the highest in the hospital, with people between 60 - 80 years old having being the highest in the clinic and people more than 80 years old being the next most occurring patients.
To know the age(not age group) that is most occurring, we can simply group by the age them.

```{r}
health_rec %>%
  group_by(age) %>%
  summarize(frequency = n()) %>%
  slice_max(order_by = frequency, n = 5)
```

## Question 2

which age group of patients dies more in the hospital?

```{r}
#dead_patients <- health_rec[outcome == 1,c("outcome","age","gender") ]

health_rec %>%
  mutate(outcome = ifelse(outcome == 0, "alive", "dead")) %>%
  group_by(factor(age), gender) %>%
  summarize(dead_patients = length(outcome))
```

The result shows the frequency table for dead patients according to age.

```{r}
barplot(sort(table(dead_patients$age)),
        col = 'purple',
        xlab = 'age (years)',
        ylab = 'Frequency',
        main = 'Distribution of Age for Dead Patients',
        ylim = c(0, 30))
```

**ANSWER** Patients at age 89 are the highest to die, with 23 patients
dying

## Question 3:

What is the most prevalent gender in the hospital

```{r}
gender <- as.data.frame(sort(table(health_rec$gender), decreasing = T)) # This gives a frequency of the genders
  ## Female gender is more prevalent with 618 patients

colnames(gender) <- c('gender','num') #changing column names
```

### Question 3b:

what is the death rate of both gender

```{r}
gender_dead_count <- as.data.frame(sort(table(dead_patients$gender))) #Frequency for dead patients according to gender
colnames(gender_dead_count) <- c('gender', 'count')

gender[3] <- gender_dead_count$count

names(gender)[3] <- 'dead' # this is similar to using colnames

gender$rate <- gender$dead/gender$num * 100 #rate of death per hundred
```

It seems the male gender is having more dead rate than female

```{r}
barplot(gender$rate,
        names.arg = gender$gender,
        xlab = substitute(paste(bold('gender'))),
        ylab = substitute(paste(bold('death rate per hundred'))),
        main = 'Death rate of genders',
        col = c(5,7))
```

## Question 4

Gender group with the highest number of death?

```{r}
sort(table((dead_patients$gender)), decreasing = T)
```

the gender with the highest death is male with 80 individuals dead

------------------------------------------------------------------------

## Question 5

How many patients died in the hospital with atrialfibrillation?

```{r}
dead_patients_atrial <- as.data.frame(health_rec %>% select(outcome, atrialfibrillation) %>% 
  filter(outcome == 'Dead') %>% group_by(atrialfibrillation)%>%
  summarize(length = length(atrialfibrillation)))

dead_patients_atrial
```

67 patients died having atrialfibrillation

### Question 5b

patients having atrialfibrillation

```{r}
atrial <- as.data.frame(health_rec %>% select(gender, atrialfibrillation) %>% 
  filter(atrialfibrillation == 'Having') %>% group_by(gender)%>%
  summarize(atrial = length(atrialfibrillation))) # this gets the number of having atril... for each gender

gender <- merge(gender, atrial, by = 'gender', all = T)
```

`r sum(gender$atrial)` is the number of patients having
atrialfibrillation

### Question 5c

Number of patients that died between the gender having
atrialfibrillation

```{r}
dead_patients_atrial_gender <-
as.data.frame(health_rec %>% select(outcome, gender,
atrialfibrillation) %>% filter(outcome == 'Dead',
atrialfibrillation=='Having') %>% group_by(gender) %>%
summarize(died_having_atrial = length(gender)))

dead_patients_atrial_gender
```

39 female and 28 male died having atrialfibrillation

```{r}
gender <- merge(gender,
dead_patients_atrial_gender, by = 'gender', all = TRUE)
```

merging the result to gender table

################################################################################ 

## Question 6

How many patients in the hospital have depression?

```{r}
(sort(table(health_rec$depression)))  

barplot(sort(table(health_rec$depression)),
  ylab = 'number of patients',
  xlab = 'depression',
  main = 'patients having depression',
  col = 'green')
```

1036 out of 1176 patients are having depression

### Question 6b1

show the total number of depressed male and female

```{r}
depressed_individuals <- health_rec %>% select(gender, depression)%>%
  filter(depression == 'Having') %>% 
  group_by(gender) %>%
  summarize(depressed_individuals = length(depression))
depressed_individuals
```

```{r}
gender <- merge(gender, depressed_individuals, by = 'gender', all =
TRUE) #merging result to gender table
```

#### Question 6b2

show the number of patients having depression that are dead according to
gender.

```{r}
dead_depressed <- as.data.frame(health_rec %>%
                                  select(outcome, gender, depression) %>%
                                  filter(outcome == 'Dead', depression == 'Having') %>%
                                  group_by(gender) %>%
                                  summarize(depressed_and_dead =length(depression)))
dead_depressed
```

```{r}
gender <- merge(gender, dead_depressed, by = 'gender', all =
TRUE) # merging the result to gender table
```

```{r}
barchart(depressed_and_dead~gender,
         data = dead_depressed,
         ylim = c(0,90),
         col = 'purple') ## show data value on the chart
```

### Question 6c

Show the number of dead patients having or not having depression
according to the genders

```{r}
dep_not_dep<- as.data.frame(health_rec %>%
                              select(outcome, gender, depression) %>%
                              filter(outcome == 'Dead') %>%
                              group_by(gender, depression) %>%
                              summarize(num_of_patients = length(depression)))
dep_not_dep
```

```{r}
barchart(num_of_patients~depression|gender,
         data = dep_not_dep,
         group= depression,
         xlab = substitute(paste(bold('Depression'))),
         ylab = substitute(paste(bold('Number of patients'))))
```

## Question 8

what is the rate of non-survived patients with hypertension?

```{r}
dead_hyper <- health_rec %>%
  select(outcome, hypertensive) %>%
  filter(hypertensive == 'Having', outcome == 'Dead') %>%
  summarize(dead_hypertensive = length(hypertensive)) # this returns the patients that are dead and had hypertension

hypertensive <- health_rec %>%
  select(outcome, hypertensive) %>%
  filter(hypertensive == 'Having') %>%
  summarize(hypertensive = length(hypertensive)) #this returns all the patients with hypertension

dead_hyper$dead_hypertensive/  hypertensive$hypertensive * 100 #proportion of the dead hypertensive patients
```

# Question 9

Rate of the different gender with hypertension per 100 patients

```{r}
gender_hyper <- as.data.frame(health_rec %>% select(gender,
hypertensive) %>% filter (hypertensive == 'Having') %>%
group_by(gender) %>% summarize (hypertensive_tot =
length(hypertensive)))

gender <- merge(gender, gender_hyper, by = 'gender', all = T) #merging to gender
gender$rate_hyper <- gender$hypertensive_tot/gender$num * 100 ##estimating the rate
```

```{r}
gender[, c('gender','rate_hyper')]
```

**ANSWER** 28 female and 29 male patients per 100 are having
hypertension

###Question 9b patients having hypertension and dead

```{r}
dead_gender_hyper <- as.data.frame(health_rec %>%
                                     select(outcome,gender, hypertensive)%>%
                                     filter (outcome == 'Dead',hypertensive == 'Having') %>%
                                     group_by(gender) %>%
                                     summarize (hypertensive_dead = length(hypertensive))) # this separates the dead hypertensive patients according to gender
```

**ANSWER** 31 female and 27 male of the dead patients had hypertension

```{r}
gender <- merge(gender, dead_gender_hyper, by = 'gender', all = T)
```

## Question 10

How many patients with renal failure are alive in the hospital?

```{r}
health_rec %>%
  select(outcome, Renal_failure) %>%
  filter(outcome == 'Alive', Renal_failure == 'Having') %>%
  summarise(length(Renal_failure))
```

**ANSWER** 392 patients are having renal failure and alive

### Question 10b

How many patients died having renal failure

```{r}
health_rec %>%
  select(outcome, Renal_failure) %>%
  filter(outcome == 'Dead', Renal_failure == 'Having') %>%
  summarise(length(Renal_failure))
```

**ANSWER**37 patients died having renal failure

### Question 10C1

People with renal failure according to gender

```{r}
renal <- as.data.frame(health_rec %>%
     select(gender, Renal_failure)%>%
     filter(Renal_failure == 'Having') %>%
     group_by(gender) %>%
     summarise(renal_failure = length(Renal_failure)))

renal
```

```{r}
gender <- merge(gender, renal, by = 'gender', all = T) #merging result to gender dataframe
```

#### 10C2

num of patients that died having renal failure according to gender

```{r}
renal_dead <- as.data.frame(health_rec %>% select(outcome,
gender,Renal_failure) %>% filter(outcome == 'Dead', Renal_failure ==
'Having') %>% group_by(gender) %>% summarise(length(Renal_failure)))
```

```{r}
gender <- merge(gender, renal_dead, by = 'gender', all = T) #merging result to gender dataframe
```

## Question 11

How many patients in the hospital with Hyperlipemia are dead?

```{r}
dead_hyperli <- as.data.frame(health_rec %>%
                                select(outcome, gender, Hyperlipemia) %>%
                                filter(outcome == 'Dead', Hyperlipemia == 'Having') %>%
                                group_by(gender) %>%
                                summarize (dead_hyperli = length(Hyperlipemia)))

gender <- merge(gender, dead_hyperli, by = 'gender', all = T) # merging to gender
```

**ANSWER** `rsum(gender$dead_hyperli)` patients died having
hyperlipermia

### Question 11b

How many patients are having hyperlipemia

```{r}
hyperli <- as.data.frame(health_rec %>%
                           select(gender, Hyperlipemia) %>%
                           filter(Hyperlipemia == 'Having') %>%
                           group_by(gender) %>% 
                           summarize(hyperlip = length(Hyperlipemia)))
```

`r sum(hyperli$hyperlip)` patients are having hyperlipermia

```{r}
gender <- merge(gender, hyperli, by = 'gender', all = T) # merging to gender
```

## Question 12

how many patients in the hospital with Anemia are dead?

```{r}
anemia <- as.data.frame(health_rec %>%
                          select(outcome, gender, deficiencyanemias) %>%
                          filter(outcome == 'Dead', deficiencyanemias == 'Having') %>%
                          group_by(gender) %>%
                          summarise(anemia_dead = length(deficiencyanemias)))
gender<- merge(gender, anemia, by = 'gender', all = T) # merging to gender 
```

`r sum(gender$anemia_dead)` is the sum of dead patients having anemia

### Question 12b

Total sum of patients having anemia

```{r}
anemia_tot <- as.data.frame(health_rec %>%
        select(gender,deficiencyanemias) %>%
        filter(deficiencyanemias == 'Having') %>%
        group_by(gender) %>%
        summarise(anemia_tot = length(deficiencyanemias)))

gender <- merge(gender, anemia_tot, by = 'gender', all = T) #merging to gender
```

`r sum(gender$anemia_tot)` patients is having anemia

------------------------------------------------------------------------

## 13

What is the proportion of survival and non-survival between diabetic and
non-diabetic patients

***Short preview of the stats relating to diabetic patients***

```{r}
health_rec %>% select(outcome, diabetes) %>% group_by(outcome,
diabetes) %>% summarize(count = length(diabetes))
```

### 13a1

The proportion of patients having diabetes

```{r}
diabeteic <- as.data.frame(health_rec %>% 
                             select(diabetes) %>%
                             filter(diabetes == 'Having') %>% 
                             summarize(length(diabetes))) # this returns the total number of diabetic patients

diabeteic$`length(diabetes)`/length(health_rec$outcome) # this returns the percentage of diabetic patients
```

**ANSWER** 57.9% of the patients are diabetic

### 13b

Proportion of diabetic that survived

To get the proportion of diabetic patient that survived, we need to know
the total number of people having diabetic and we divide that by the
number of people having diabetes and survived

```{r}
having_diabetes_alive <- as.data.frame(health_rec %>%
   select(outcome, diabetes) %>%
   filter(outcome == 'Alive', diabetes == 'Having') %>%
   summarize(having_diabetes = length(diabetes))) # returns the patients having diabetes and still alive
  
having_diabetes <- as.data.frame(health_rec %>%
   select(diabetes) %>%
   filter(diabetes == 'Having') %>%
   summarize(diabetic = length(diabetes))) # returns patients having diabetes dead or alive

having_diabetes_alive$having_diabetes/having_diabetes$diabetic * 100 # proportion of diabetic patients alive
```

**ANSWER** 85% of diabetic patients are alive

#### 13b2

Proportion of non-diabetic that survived. For this we follow the same
procedure as the one above but this time, the patients are not diabetic

```{r}
non_diabetic_alive <- health_rec %>% 
  select(outcome, diabetes) %>%
  filter(outcome == 'Alive', diabetes == 'Not Having') %>%
  summarize(non_diabetes = length(diabetes)) # this returns non-diabetic patients that are alive

non_diabetic <- health_rec %>%
  select(diabetes) %>%
  filter(diabetes == 'Not Having') %>%
  summarize(non_diabetic = length(diabetes)) #this returns non-diabetic dead or alive

non_diabetic_alive$non_diabetes/non_diabetic$non_diabetic * 100 # this returns the proportion of non-diabetic that are alive 
```

**ANSWER**`r non_diabetic_alive$non_diabetes/non_diabetic$non_diabetic * 100`%
of the patients are not having diabetes and are alive

### 13c

Proportion of diabetic that died

```{r}
dead_diabetic <- health_rec %>%
  select(outcome, diabetes) %>%
  filter(diabetes == 'Having', outcome == 'Dead') %>%
  summarize (diabetic = length(diabetes)) # num of dead diabetic patients

dead_diabetic$diabetic/having_diabetes$diabetic * 100 #this returns the proportion of dead diabetics 
```

**ANSWER** about 14.98 percent of the diabetics are dead

#### 13c2

Proportion of non_diabetic that died

```{r}
dead_non_diabetic <- health_rec %>% 
  select(outcome, diabetes) %>%
  filter(diabetes == 'Not Having', outcome == 'Dead') %>%
  summarize (non_diabetic=length(diabetes)) # num of dead non-diabetic patients

dead_non_diabetic$non_diabetic/non_diabetic$non_diabetic * 100 # this returns the proportion of dead non-diabetics
```

**ANSWER** 11.52 percent of non diabetics are dead.

## Question 14

What is the proportion of survival and non-survival between depressed
and non-depressed patients

***Short preview of the stats relating to depressed patients***

```{r}
health_rec %>% select(outcome, depression) %>%
  group_by(outcome, depression) %>%
  summarize(count = length(outcome))
```

## Question 14a

What is the proportion of depressed and non-depressed that survived

```{r}
depressed <- as.data.frame(health_rec %>% 
   select(depression) %>% 
   filter(depression == 'Having') %>%
   summarize(depressed = length(depression))) # this returns the total number of depressed patients either dead or alive

depressed$depressed/length(health_rec$outcome) # this returns the percentage of depressed patients
```

**ANSWER**88.1 percent of the patients are depressed

### 14a1

Proportion of depressed patients that survived

```{r}
having_depression_alive <- as.data.frame(health_rec %>% 
     select(outcome, depression) %>%
     filter(outcome == 'Alive', depression == 'Having') %>%
     summarize(having_depression = length(depression))) # returns the patients having depression and still alive

having_depression_alive$having_depression/depressed$depressed * 100 # proportion of depressed patients alive
```

**ANSWER** 85.7% of depressed patients are alive

#### 14a2

Proportion of non-depressed that survived

For this we follow the same procedure as the one above but this time,
the patients are not depressed

```{r}
non_depressed_alive <- health_rec %>%
  select(outcome, depression) %>%
  filter(outcome == 'Alive', depression == 'Not Having') %>%
  summarize(non_depression = length(depression)) #this returns non-depressed patients that are alive

non_depressed <- health_rec %>% select(depression) %>%
filter(depression == 'Not Having') %>% summarize(non_depressed =
length(depression)) #this returns non-depressed patients count dead or alive

non_depressed_alive$non_depression/non_depressed$non_depressed * 100 # this returns the proportion of non-depressed patients that are alive
```

**ANSWER**92.1% percent of the patients are not having depression and
are alive

### 14b1

Proportion of depressed patients that died

```{r}
dead_depressed <-health_rec %>%
  select(outcome, depression) %>%
  filter(depression == 'Having', outcome == 'Dead') %>% 
  summarize (depressed = length(depression)) # num of dead depressed patients

dead_depressed$depressed/depressed$depressed * 100 #this returns the proportion of dead depressed patients
```

**ANSWER** about 14.28 percent of the depressed patients are dead

#### 14b2

Proportion of non_depressed patients that died

```{r}
dead_non_depressed <- health_rec %>% 
  select(outcome, depression) %>% 
  filter(depression== 'Not Having', outcome == 'Dead') %>% 
  summarize(non_depressed=length(depression)) # num of dead non-diabetic patients

dead_non_depressed$non_depressed/non_depressed$non_depressed * 100 # this returns the proportion of dead non-diabetics 
```

**ANSWER** 7.86 percent of the non-depressed patients are dead.

[Back to Homepage](https://olamideadu.com)
